import pandas as pd

# Load dataset
df = pd.read_csv("data/raw/HHS_Unaccompanied_Alien_Children_Program.csv")

# Drop rows with missing dates
df = df.dropna(subset=["Date"])

# Convert Date to datetime
df["Date"] = pd.to_datetime(df["Date"])

# Clean numeric columns with commas
df["Children in HHS Care"] = (
    df["Children in HHS Care"]
    .str.replace(",", "")
    .astype(int)
)

numeric_cols = [
    "Children apprehended and placed in CBP custody*",
    "Children in CBP custody",
    "Children transferred out of CBP custody",
    "Children discharged from HHS Care"
]

df[numeric_cols] = df[numeric_cols].astype(int)

# Sort by date
df = df.sort_values("Date")

# Save cleaned data
df.to_csv("data/processed/cleaned_data.csv", index=False)

print(" Data cleaned successfully")
